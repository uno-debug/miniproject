;/*FB_PKG_DELIM*/

__d("WASmaxInBlocklistsGetOptOutListResponseInternalServerError",["WAResultOrError","WASmaxInBlocklistsIQErrorFeatureNotImplementedOrInternalServerErrorMixinGroup","WASmaxInBlocklistsIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInBlocklistsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInBlocklistsIQErrorFeatureNotImplementedOrInternalServerErrorMixinGroup").parseIQErrorFeatureNotImplementedOrInternalServerErrorMixinGroup(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorIQErrorFeatureNotImplementedOrInternalServerErrorMixinGroup:b.value}))}g.parseGetOptOutListResponseInternalServerError=a}),98);
__d("WASmaxInBlocklistsGetOptOutListResponseInvalidRequest",["WAResultOrError","WASmaxInBlocklistsIQErrorBadRequestOrRateOverlimitMixinGroup","WASmaxInBlocklistsIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInBlocklistsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInBlocklistsIQErrorBadRequestOrRateOverlimitMixinGroup").parseIQErrorBadRequestOrRateOverlimitMixinGroup(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorIQErrorBadRequestOrRateOverlimitMixinGroup:b.value}))}g.parseGetOptOutListResponseInvalidRequest=a}),98);
__d("WASmaxInBlocklistsGetOptOutListResponseSuccessWithMatch",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");if(!c.success)return c;var e=d("WASmaxParseReference").optionalAttrStringFromReference(b,["category"]);if(!e.success)return e;e=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,a,"category",e.value);if(!e.success)return e;b=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",b.value);return!a.success?a:d("WAResultOrError").makeResult({type:c.value,hasCategory:e.value!=null})}g.parseGetOptOutListResponseSuccessWithMatch=a}),98);
__d("WASmaxInBlocklistsBizOptOutBrandIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrString(a,"biz_opt_out_brand_id");return!a.success?a:d("WAResultOrError").makeResult({bizOptOutBrandId:a.value})}g.parseBizOptOutBrandIDMixin=a}),98);
__d("WASmaxInBlocklistsBizOptOutJidMixin",["WAResultOrError","WASmaxParseJid"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseJid").attrUserJid(a,"biz_opt_out_jid");return!a.success?a:d("WAResultOrError").makeResult({bizOptOutJid:a.value})}g.parseBizOptOutJidMixin=a}),98);
__d("WASmaxInBlocklistsBizOptOutBrandIDOrJidMixinGroup",["WAResultOrError","WASmaxInBlocklistsBizOptOutBrandIDMixin","WASmaxInBlocklistsBizOptOutJidMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInBlocklistsBizOptOutBrandIDMixin").parseBizOptOutBrandIDMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"BizOptOutBrandID",value:b.value});var c=d("WASmaxInBlocklistsBizOptOutJidMixin").parseBizOptOutJidMixin(a);return c.success?d("WAResultOrError").makeResult({name:"BizOptOutJid",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["BizOptOutBrandID","BizOptOutJid"],[b,c])}g.parseBizOptOutBrandIDOrJidMixinGroup=a}),98);
__d("WASmaxInBlocklistsBizOptOutResponseMixin",["WAResultOrError","WASmaxInBlocklistsBizOptOutBrandIDOrJidMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"action");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"category");if(!c.success)return c;a=d("WASmaxInBlocklistsBizOptOutBrandIDOrJidMixinGroup").parseBizOptOutBrandIDOrJidMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({action:b.value,category:c.value,bizOptOutBrandIDOrJidMixinGroup:a.value})}g.parseBizOptOutResponseMixin=a}),98);
__d("WASmaxInBlocklistsGetOptOutListResponseSuccessWithMismatch",["WAResultOrError","WASmaxInBlocklistsBizOptOutResponseMixin","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"item");if(!b.success)return b;b=d("WASmaxInBlocklistsBizOptOutResponseMixin").parseBizOptOutResponseMixin(a);return!b.success?b:b}function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"list");if(!c.success)return c;var e=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",e.value);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");if(!e.success)return e;b=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",b.value);if(!a.success)return a;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,c.value,"dhash");if(!b.success)return b;a=d("WASmaxParseUtils").mapChildrenWithTag(c.value,"item",0,64e3,h);return!a.success?a:d("WAResultOrError").makeResult({type:e.value,listDhash:b.value,listItem:a.value})}g.parseGetOptOutListResponseSuccessWithMismatchListItem=h;g.parseGetOptOutListResponseSuccessWithMismatch=a}),98);
__d("WASmaxOutBlocklistsGetOptOutListRequest",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.itemDhash;a=d("WASmaxJsx").smax("item",{dhash:d("WAWap").CUSTOM_STRING(a)});return a}function a(a){var b=a.itemArgs;a=a.iqCategory;a=d("WASmaxJsx").smax("iq",{to:d("WAWap").S_WHATSAPP_NET,xmlns:"optoutlist",type:"get",category:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a),id:d("WAWap").generateId()},d("WASmaxChildren").OPTIONAL_CHILD(h,b));return a}g.makeGetOptOutListRequestItem=h;g.makeGetOptOutListRequest=a}),98);
__d("WASmaxBlocklistsGetOptOutListRPC",["WAComms","WASmaxInBlocklistsGetOptOutListResponseInternalServerError","WASmaxInBlocklistsGetOptOutListResponseInvalidRequest","WASmaxInBlocklistsGetOptOutListResponseSuccessWithMatch","WASmaxInBlocklistsGetOptOutListResponseSuccessWithMismatch","WASmaxOutBlocklistsGetOptOutListRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:e=d("WASmaxOutBlocklistsGetOptOutListRequest").makeGetOptOutListRequest(a);k.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=k.sent;g=d("WASmaxInBlocklistsGetOptOutListResponseSuccessWithMismatch").parseGetOptOutListResponseSuccessWithMismatch(f,e);if(!g.success){k.next=7;break}return k.abrupt("return",{name:"GetOptOutListResponseSuccessWithMismatch",value:g.value});case 7:h=d("WASmaxInBlocklistsGetOptOutListResponseSuccessWithMatch").parseGetOptOutListResponseSuccessWithMatch(f,e);if(!h.success){k.next=10;break}return k.abrupt("return",{name:"GetOptOutListResponseSuccessWithMatch",value:h.value});case 10:i=d("WASmaxInBlocklistsGetOptOutListResponseInvalidRequest").parseGetOptOutListResponseInvalidRequest(f,e);if(!i.success){k.next=13;break}return k.abrupt("return",{name:"GetOptOutListResponseInvalidRequest",value:i.value});case 13:j=d("WASmaxInBlocklistsGetOptOutListResponseInternalServerError").parseGetOptOutListResponseInternalServerError(f,e);if(!j.success){k.next=16;break}return k.abrupt("return",{name:"GetOptOutListResponseInternalServerError",value:j.value});case 16:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("GetOptOutList",{SuccessWithMismatch:g,SuccessWithMatch:h,InvalidRequest:i,InternalServerError:j}));case 17:case"end":return k.stop()}},null,this)}g.sendGetOptOutListRPC=a}),98);
__d("WAWebApiOptOutList",["Promise","WAWebModelStorageUtils","WAWebSchemaOptOutList","WAWebWidFactory"],(function(a,b,c,d,e,f,g){var h;function a(){return d("WAWebSchemaOptOutList").getOptOutListTable().all().then(function(a){a=a.map(function(a){return d("WAWebWidFactory").createUserWid(a.id)});return a})}function c(a){if(!a)return(h||(h=b("Promise"))).resolve(!1);var c=a.map(function(a){return{id:a.toString()}});return d("WAWebModelStorageUtils").getStorage().lock(["optoutlist"],function(a){var b=a[0];return b.clear().then(function(){return b.bulkCreate(c).then(function(){return!0})})})}g.getOptOutList=a;g.updateOptOutList=c}),98);
__d("WAWebGetOptOutList",["WASmaxBlocklistsGetOptOutListRPC","WAWebJidToWid","WAWebUserPrefsMultiDevice","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebUserPrefsMultiDevice").getOptOutListHash());b={itemArgs:b!=null?{itemDhash:b}:void 0,iqCategory:a};a=(yield d("WASmaxBlocklistsGetOptOutListRPC").sendGetOptOutListRPC(b));switch(a.name){case"GetOptOutListResponseSuccessWithMatch":b={wids:[]};return b;case"GetOptOutListResponseSuccessWithMismatch":var c={wids:[]};b=a.value.listDhash;var e=a.value.listItem;b!=null&&(c.dhash=b);e.forEach(function(a){if(a.bizOptOutBrandIDOrJidMixinGroup.name==="BizOptOutJid"){var b=d("WAWebJidToWid").userJidToUserWid(a.bizOptOutBrandIDOrJidMixinGroup.value.bizOptOutJid);c.wids.push({wid:b,category:a.category})}});return c;case"GetOptOutListResponseInvalidRequest":b=a.value.errorIQErrorBadRequestOrRateOverlimitMixinGroup.value;e=b.code;b=b.text;return{errorCode:Number(e),errorText:b};case"GetOptOutListResponseInternalServerError":e=a.value.errorIQErrorFeatureNotImplementedOrInternalServerErrorMixinGroup.value;b=e.code;a=e.text;return{errorCode:Number(b),errorText:a}}});return h.apply(this,arguments)}g.getOptOutList=a}),98);
__d("WAWebQueryOptOutListJob",["WALogger","WAWebApiOptOutList","WAWebGetOptOutList","WAWebUpdateLidMetadataJob","WAWebUserPrefsMultiDevice","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[OptOutUserJob] no change in optoutlist, skip update"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[OptOutUserJob] updating optoutlist with "," contact(s)"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[OptOutUserJob] fetch optoutlist using optoutlist"]);j=function(){return a};return a}function a(){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WALogger").LOG(j());var a=(yield d("WAWebGetOptOutList").getOptOutList());if(a.errorCode!=null)return a;if(a.dhash!=null&&a.dhash!==""){d("WALogger").LOG(i(),a.wids.length||0);yield d("WAWebUserPrefsMultiDevice").setOptOutlistHash(a.dhash);yield d("WAWebApiOptOutList").updateOptOutList(a.wids.map(function(a){return a.wid}));var b=a.wids.map(function(a){a=a.wid;if(!a.isLid())return null;var b={};return{lid:d("WAWebWidFactory").toUserWid(a),data:b}}).filter(Boolean);yield d("WAWebUpdateLidMetadataJob").updateLidMetadataJob(b)}else d("WALogger").LOG(h());return a});return k.apply(this,arguments)}g.fetchAndUpdateOptOutList=a}),98);
__d("WAWebOptOutSyncJob",["WAWebMarketingMessagesUserFeedbackGatingUtils","WAWebQueryOptOutListJob","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!d("WAWebMarketingMessagesUserFeedbackGatingUtils").isMMOptOutEnabled()||!d("WAWebMarketingMessagesUserFeedbackGatingUtils").isMMOptOutListServerSyncEnabled())return;var a=(yield d("WAWebQueryOptOutListJob").fetchAndUpdateOptOutList());a.dhash!=null&&a.dhash!==""&&d("WAWebWorkerSafeBackendApi").workerSafeFireAndForget("updateOptOutListCollection",{wids:a.wids})});return h.apply(this,arguments)}g.updateOptOutList=a}),98);